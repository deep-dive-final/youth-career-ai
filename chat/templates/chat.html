{% load static %}

<!doctype html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AI ìƒë‹´ - ì •ì±… ì¶”ì²œ ì„œë¹„ìŠ¤</title>
    <link rel="stylesheet" href="{% static 'css/style.css' %}" />
    <style>
      .chat-container {
        height: calc(100vh - 180px);
        display: flex;
        flex-direction: column;
      }
      .chat-messages {
        flex: 1;
        overflow-y: auto;
        padding: 20px;
        display: flex;
        flex-direction: column;
        gap: 16px;
      }
      .chat-message {
        display: flex;
        gap: 12px;
        animation: slideIn 0.3s ease;
      }
      @keyframes slideIn {
        from {
          opacity: 0;
          transform: translateY(10px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
      .chat-message.user {
        flex-direction: row-reverse;
      }
      .chat-avatar {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        flex-shrink: 0;
      }
      .chat-avatar.ai {
        background: linear-gradient(to bottom right, #a8e6cf, #7ec4cf);
      }
      .chat-avatar.user {
        background: linear-gradient(to bottom right, #a29bfe, #6c5ce7);
      }
      .chat-bubble {
        max-width: 70%;
        padding: 12px 16px;
        border-radius: 20px;
        font-size: 14px;
        line-height: 1.5;
      }
      .chat-bubble.ai {
        background: white;
        color: #2d3748;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
      }
      .chat-bubble.user {
        background: linear-gradient(to right, #a29bfe, #6c5ce7);
        color: white;
      }
      .chat-input-wrapper {
        padding: 16px 20px;
        background: white;
        border-top: 1px solid #e2e8f0;
      }
      .chat-input-form {
        display: flex;
        gap: 8px;
      }
      .chat-input {
        flex: 1;
        padding: 12px 16px;
        border-radius: 50px;
        border: 1px solid #e2e8f0;
        font-size: 14px;
        font-family: "Jua", sans-serif;
      }
      .chat-send-btn {
        width: 48px;
        height: 48px;
        border-radius: 50%;
        background: linear-gradient(to bottom right, #a8e6cf, #7ec4cf);
        border: none;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        transition: all 0.3s;
      }
      .chat-send-btn:hover {
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      }
      .chat-send-btn:disabled {
        opacity: 0.5;
        cursor: not-allowed;
      }
      .quick-questions {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
        padding: 0 20px 16px;
      }
      .quick-question-btn {
        padding: 8px 16px;
        background: white;
        border: 1px solid #e2e8f0;
        border-radius: 50px;
        font-size: 13px;
        font-family: "Jua", sans-serif;
        cursor: pointer;
        transition: all 0.2s;
      }
      .quick-question-btn:hover {
        border-color: #7ec4cf;
        background: #f8f9fd;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="header">
        <div class="header-top">
          <button class="btn-icon" onclick="goBack()">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="20"
              height="20"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <line x1="19" y1="12" x2="5" y2="12"></line>
              <polyline points="12 19 5 12 12 5"></polyline>
            </svg>
          </button>
          <div style="flex: 1; text-align: center">
            <h2 style="margin: 0">AI ìƒë‹´</h2>
            <p style="margin: 0; font-size: 12px; color: #a0aec0">
              24ì‹œê°„ ì–¸ì œë‚˜ ìƒë‹´ ê°€ëŠ¥
            </p>
          </div>
          <div style="width: 44px"></div>
        </div>
      </div>

      <div class="chat-container">
        <div id="chatMessages" class="chat-messages"></div>

        <div class="quick-questions" id="quickQuestions">
          <button
            class="quick-question-btn"
            onclick="sendMessage('ì²­ë…„ ì›”ì„¸ ì§€ì›ì‚¬ì—…ì— ëŒ€í•´ ì•Œë ¤ì¤˜')"
          >
            ì²­ë…„ ì›”ì„¸ ì§€ì›ì‚¬ì—…
          </button>
          <button
            class="quick-question-btn"
            onclick="sendMessage('ë‚˜ì´ 25ì„¸ì— ë°›ì„ ìˆ˜ ìˆëŠ” ì •ì±…ì€?')"
          >
            ë‚˜ì´ë³„ ì •ì±…
          </button>
          <button
            class="quick-question-btn"
            onclick="sendMessage('ì·¨ì—… ê´€ë ¨ ì •ì±… ì¶”ì²œí•´ì¤˜')"
          >
            ì·¨ì—… ì •ì±…
          </button>
          <button
            class="quick-question-btn"
            onclick="sendMessage('ì‹ ì²­ ë°©ë²•ì´ ê¶ê¸ˆí•´')"
          >
            ì‹ ì²­ ë°©ë²•
          </button>
        </div>

        <div class="chat-input-wrapper">
          <form class="chat-input-form" onsubmit="handleSubmit(event)">
            <input
              type="text"
              id="chatInput"
              class="chat-input"
              placeholder="ê¶ê¸ˆí•œ ì ì„ ë¬¼ì–´ë³´ì„¸ìš”..."
              autocomplete="off"
            />
            <button type="submit" id="sendBtn" class="chat-send-btn">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="20"
                height="20"
                viewBox="0 0 24 24"
                fill="none"
                stroke="white"
                stroke-width="2"
              >
                <line x1="22" y1="2" x2="11" y2="13"></line>
                <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
              </svg>
            </button>
          </form>
        </div>
      </div>
    </div>

    <!-- Floating Home Button -->
    <button
      id="floatingHome"
      class="floating-home"
      onclick="window.location.href = 'index.html'"
    >
      <svg
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
      >
        <path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
        <polyline points="9 22 9 12 15 12 15 22"></polyline>
      </svg>
    </button>

    <script src="{% static 'js/data.js' %}"></script>
    <script src="{% static 'js/main.js' %}"></script>
    <script>
      const chatMessages = document.getElementById("chatMessages");
      const chatInput = document.getElementById("chatInput");
      const sendBtn = document.getElementById("sendBtn");
      const quickQuestions = document.getElementById("quickQuestions");

      // ì´ˆê¸° ë©”ì‹œì§€
      function addWelcomeMessage() {
        addAIMessage(
          "ì•ˆë…•í•˜ì„¸ìš”! ğŸ‘‹\nì •ì±… ì¶”ì²œ AI ìƒë‹´ì‚¬ì…ë‹ˆë‹¤.\n\nê¶ê¸ˆí•˜ì‹  ì •ì±…ì´ë‚˜ ì‹ ì²­ ë°©ë²•ì— ëŒ€í•´ ë¬¼ì–´ë³´ì„¸ìš”!",
        );
      }

      function addMessage(text, isUser) {
        const messageDiv = document.createElement("div");
        messageDiv.className = `chat-message ${isUser ? "user" : "ai"}`;

        messageDiv.innerHTML = `
        <div class="chat-avatar ${isUser ? "user" : "ai"}">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
            ${
              isUser
                ? '<path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle>'
                : '<path d="M12 2a2 2 0 0 1 2 2c0 .74-.4 1.39-1 1.73V7h1a7 7 0 0 1 7 7h1a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-1v1a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-1H2a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1h1a7 7 0 0 1 7-7h1V5.73c-.6-.34-1-.99-1-1.73a2 2 0 0 1 2-2z"></path>'
            }
          </svg>
        </div>
        <div class="chat-bubble ${isUser ? "user" : "ai"}">${text.replace(/\n/g, "<br>")}</div>
      `;

        chatMessages.appendChild(messageDiv);
        chatMessages.scrollTop = chatMessages.scrollHeight;
      }

      function addAIMessage(text) {
        addMessage(text, false);
      }

      function addUserMessage(text) {
        addMessage(text, true);
      }

      function handleSubmit(event) {
        event.preventDefault();
        const text = chatInput.value.trim();

        if (!text) return;

        sendMessage(text);
        chatInput.value = "";
      }

      function sendMessage(text) {
        // ë¹ ë¥¸ ì§ˆë¬¸ ë²„íŠ¼ ìˆ¨ê¸°ê¸°
        quickQuestions.style.display = "none";

        addUserMessage(text);

        // ì…ë ¥ ë¹„í™œì„±í™”
        sendBtn.disabled = true;
        chatInput.disabled = true;

        // AI ì‘ë‹µ ì‹œë®¬ë ˆì´ì…˜
        setTimeout(() => {
          const response = getAIResponse(text);
          addAIMessage(response);

          sendBtn.disabled = false;
          chatInput.disabled = false;
          chatInput.focus();
        }, 1000);
      }

      function getAIResponse(userMessage) {
        const lowerMessage = userMessage.toLowerCase();

        // í‚¤ì›Œë“œ ê¸°ë°˜ ì‘ë‹µ
        if (lowerMessage.includes("ì›”ì„¸") || lowerMessage.includes("ì£¼ê±°")) {
          return "ì²­ë…„ ì›”ì„¸ ì§€ì›ì‚¬ì—…ì„ ì¶”ì²œë“œë¦½ë‹ˆë‹¤! ğŸ’°\n\në§Œ 19~34ì„¸ ë¬´ì£¼íƒ ì²­ë…„ì—ê²Œ ì›” ìµœëŒ€ 20ë§Œì›ì”© 12ê°œì›”ê°„ ì§€ì›í•©ë‹ˆë‹¤.\n\nâ€¢ ì§€ì› ê¸ˆì•¡: ìµœëŒ€ 240ë§Œì›\nâ€¢ ë§ˆê°: D-5 (ì„œë‘˜ëŸ¬ì£¼ì„¸ìš”!)\nâ€¢ ë§¤ì¹­ë¥ : 95%\n\nìì„¸í•œ ë‚´ìš©ì€ ì •ì±… ìƒì„¸ í˜ì´ì§€ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”!";
        }

        if (lowerMessage.includes("ì·¨ì—…") || lowerMessage.includes("ì¼ìë¦¬")) {
          return "ì·¨ì—… ê´€ë ¨ ì¶”ì²œ ì •ì±…ì…ë‹ˆë‹¤! ğŸ’¼\n\n1. ì²­ë…„ë„ì•½ê³„ì¢Œ\n   - 5ë…„ê°„ ì €ì¶• ì‹œ ìµœëŒ€ 5,000ë§Œì›\n   - ë§¤ì¹­ë¥  88%\n\n2. ì²­ë…„ ë‚´ì¼ì±„ì›€ê³µì œ\n   - 2ë…„ ê·¼ì† ì‹œ 1,200ë§Œì›\n   - ë§¤ì¹­ë¥  82%\n\n3. ì²­ë…„ ì¼ìë¦¬ ë„ì•½ ì¥ë ¤ê¸ˆ\n   - ì›” 80ë§Œì›ì”© 12ê°œì›”\n   - ë§¤ì¹­ë¥  75%\n\nì›í•˜ì‹œëŠ” ì •ì±…ì„ ì„ íƒí•´ì„œ í™•ì¸í•´ë³´ì„¸ìš”!";
        }

        if (lowerMessage.includes("ì‹ ì²­") || lowerMessage.includes("ë°©ë²•")) {
          return 'ì •ì±… ì‹ ì²­ ë°©ë²•ì„ ì•ˆë‚´ë“œë¦½ë‹ˆë‹¤! ğŸ“\n\n1. ì›í•˜ëŠ” ì •ì±…ì„ ì„ íƒí•˜ì„¸ìš”\n2. ì •ì±… ìƒì„¸ í˜ì´ì§€ì—ì„œ "ì‹ ì²­í•˜ê¸°" í´ë¦­\n3. í•„ìš” ì„œë¥˜ë¥¼ ì¤€ë¹„í•˜ì„¸ìš”\n   (ì£¼ë¯¼ë“±ë¡ë“±ë³¸, ì†Œë“ì¦ëª…ì„œ ë“±)\n4. ì‹ ì²­ì„œë¥¼ ì‘ì„±í•˜ê³  ì œì¶œ\n5. ê²°ê³¼ëŠ” ì•Œë¦¼ìœ¼ë¡œ ë°›ìœ¼ì‹¤ ìˆ˜ ìˆì–´ìš”\n\në¡œê·¸ì¸ í›„ ì´ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤!';
        }

        if (lowerMessage.includes("ë‚˜ì´") || lowerMessage.match(/\d{2}ì„¸/)) {
          return "ë‚˜ì´ë³„ ë§ì¶¤ ì •ì±…ì„ ì¶”ì²œë“œë¦½ë‹ˆë‹¤! ğŸ¯\n\në§Œ 19~24ì„¸:\nâ€¢ ì²­ë…„ ë¬¸í™”íŒ¨ìŠ¤ (ì—° 10ë§Œì›)\n\në§Œ 25~34ì„¸:\nâ€¢ ì²­ë…„ ì›”ì„¸ ì§€ì›ì‚¬ì—…\nâ€¢ ì²­ë…„ë„ì•½ê³„ì¢Œ\nâ€¢ ì²­ë…„ ë‚´ì¼ì±„ì›€ê³µì œ\n\nì„¤ë¬¸ì¡°ì‚¬ë¥¼ ì™„ë£Œí•˜ì‹œë©´ ë” ì •í™•í•œ ë§ì¶¤ ì¶”ì²œì„ ë°›ìœ¼ì‹¤ ìˆ˜ ìˆì–´ìš”!";
        }

        if (lowerMessage.includes("ì•ˆë…•") || lowerMessage.includes("ì²˜ìŒ")) {
          return "ë°˜ê°‘ìŠµë‹ˆë‹¤! ğŸ˜Š\n\nì €ëŠ” ì²­ë…„ ì •ì±… ì¶”ì²œ AIì…ë‹ˆë‹¤.\n\në‹¤ìŒê³¼ ê°™ì€ ë„ì›€ì„ ë“œë¦´ ìˆ˜ ìˆì–´ìš”:\nâ€¢ ì •ì±… ì •ë³´ ì•ˆë‚´\nâ€¢ ë§ì¶¤ ì •ì±… ì¶”ì²œ\nâ€¢ ì‹ ì²­ ë°©ë²• ì•ˆë‚´\nâ€¢ ìê²© ìš”ê±´ í™•ì¸\n\nê¶ê¸ˆí•˜ì‹  ì ì„ í¸í•˜ê²Œ ë¬¼ì–´ë³´ì„¸ìš”!";
        }

        // ê¸°ë³¸ ì‘ë‹µ
        return 'ì£„ì†¡í•˜ì§€ë§Œ, í•´ë‹¹ ì§ˆë¬¸ì— ëŒ€í•œ ì •í™•í•œ ë‹µë³€ì„ ë“œë¦¬ê¸° ì–´ë µìŠµë‹ˆë‹¤. ğŸ˜…\n\në‹¤ìŒê³¼ ê°™ì´ ì§ˆë¬¸í•´ë³´ì„¸ìš”:\nâ€¢ "ì²­ë…„ ì›”ì„¸ ì§€ì›ì‚¬ì—…ì— ëŒ€í•´ ì•Œë ¤ì¤˜"\nâ€¢ "ì·¨ì—… ê´€ë ¨ ì •ì±… ì¶”ì²œí•´ì¤˜"\nâ€¢ "ì‹ ì²­ ë°©ë²•ì´ ê¶ê¸ˆí•´"\nâ€¢ "ë‚˜ì´ 25ì„¸ì— ë°›ì„ ìˆ˜ ìˆëŠ” ì •ì±…ì€?"\n\në˜ëŠ” ê²€ìƒ‰ í˜ì´ì§€ì—ì„œ ì§ì ‘ ì°¾ì•„ë³´ì‹¤ ìˆ˜ë„ ìˆì–´ìš”!';
      }

      document.addEventListener("DOMContentLoaded", () => {
        addWelcomeMessage();
        chatInput.focus();
      });
    </script>
  </body>
</html>
